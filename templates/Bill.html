<!DOCTYPE html>
<html>
<head>
    <title>Bus Ticket Invoice</title>
    <style>
        body { font-family: Arial; background: #f2f2f2; }
        .invoice {
            background: #fff;
            width: 650px;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ccc;
        }
        h2, h3 { text-align: center; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }
        td {
            padding: 8px;
            border-bottom: 1px solid #ddd;
        }
        .section-title {
            background: #eee;
            font-weight: bold;
            text-align: left;
        }
        .total {
            font-weight: bold;
            font-size: 18px;
            text-align: right;
        }
        .btn_section{
            cursor: progress;
            box-shadow: #181818;
            width: 25%;
            padding: 14px;
            background: linear-gradient(rgb(109, 197, 90),rgb(79, 79, 224));
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            position:relative;
            left:35%;
            margin-bottom:10px;
        }
        .btn_section:hover{
            transform: translate(-50%,-50%);
            box-shadow: 5px 8px 10px #262020;


        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>


<div class="invoice" id="invoice">

    <h2>Bus Ticket Invoice</h2>
    <!-- Passenger Details -->
    <table>
        <tr><td colspan="7" class="section-title">Passenger Details</td></tr>
        {% for inv in person_details %}
        <tr><td>{{ loop.index }}</td><td>Name</td><td>{{ inv.name }}</td><td>Phone</td><td>{{ inv.phone }}</td><td>Seat No:</td><td>{{ inv.Seat_number }}</td></tr>
        {% endfor %}

    </table>

    {% for inv in invoices %}
    <!-- Booking Details -->
    <table>
        <tr><td colspan="2" class="section-title">Booking Details</td></tr>
        <tr><td>Booking ID</td><td>{{ inv.Booking_Id }}</td></tr>
        <tr><td>From</td><td>{{ inv.source }}</td></tr>
        <tr><td>To</td><td>{{ inv.destination }}</td></tr>
        <tr><td>Seat Type</td><td>{{ inv.seat_type }}</td></tr>
        <tr><td>Bus Type</td><td>{{ inv.Selected_bus }}</td></tr>
    </table>

    <!-- Fare Details -->
    <table>
        <tr><td colspan="2" class="section-title">Fare Details</td></tr>
        <tr><td>Price per Seat</td><td>₹{{ inv.price }}</td></tr>
        <tr><td>Distance</td><td>{{ inv.distance }}Kms</td></tr>
        <tr><td>No. of Persons</td><td>{{ inv.No_passengers }}</td></tr>
        <tr>
            <td class="total">Total Price</td>
            <td class="total">₹{{ inv.Total_price }}</td>
        </tr>
    </table>
    <button class="btn_section" id="Download">Download PDF</button>
{% endfor %}
</div>
<script>
    const btn = document.getElementById('Download')
    btn.addEventListener('click', function (){
        const down_id = document.getElementById('invoice')
        const opt = {
        margin:       0.5,
        filename:     "Invoice_Bus_booking.pdf",
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 2 },
        jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' }
    };

    html2pdf().set(opt).from(down_id).save();
    });

</script>
</body>
</html>
